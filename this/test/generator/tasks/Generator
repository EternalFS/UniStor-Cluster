---
- name: Generators
  block:

  - name: All Drives
    debug:
      var: "ansible_facts.devices[item]"
    when: (ansible_facts.devices[item].vendor is defined and ansible_facts.devices[item].vendor != None )
    loop: "{{ ansible_facts.device_links.ids.keys()|list }}"


  - name: Used Drives
    debug:
      var: ansible_facts.devices[item]
    when: (ansible_facts.devices[item].vendor is defined and ansible_facts.devices[item].vendor != None ) and (ansible_facts.devices[item].partitions|length != 0)
    loop: "{{ ansible_facts.device_links.ids.keys()|list }}"


  - name: Unpartitioned Drives!
    debug:
      var: ansible_facts.devices[item]
    when: (ansible_facts.devices[item].vendor is defined and ansible_facts.devices[item].vendor != None ) and (ansible_facts.devices[item].partitions|length == 0)
    loop: "{{ ansible_facts.device_links.ids.keys()|list }}"


  - name: Generator Unpartitioned Drives
    set_fact:
      all: "{{ all + [ item ] }}"
    when: (ansible_facts.devices[item].vendor is defined and ansible_facts.devices[item].vendor != None ) and (ansible_facts.devices[item].partitions|length == 0)
    loop: "{{ ansible_facts.device_links.ids.keys()|list }}"
